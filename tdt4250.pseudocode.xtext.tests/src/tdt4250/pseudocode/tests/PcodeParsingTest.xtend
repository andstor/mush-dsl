/*
 * generated by Xtext 2.22.0
 */
package tdt4250.pseudocode.tests

import com.google.inject.Inject
import org.eclipse.xtext.testing.InjectWith
import org.eclipse.xtext.testing.extensions.InjectionExtension
import org.eclipse.xtext.testing.util.ParseHelper
import org.eclipse.xtext.util.EmfFormatter
import org.eclipse.xtext.xbase.testing.CompilationTestHelper
import org.junit.jupiter.api.Assertions
import org.junit.jupiter.api.Test
import org.junit.jupiter.api.^extension.ExtendWith
import tdt4250.pseudocode.Model

@ExtendWith(InjectionExtension)
@InjectWith(PcodeInjectorProvider)
class PcodeParsingTest {
    @Inject ParseHelper<Model> parseHelper

    @Inject extension CompilationTestHelper
    val code = '''
        package no.test.pseudo2
        
        PARTITION2(number p, number r)
            a=0
            asf=2
            print 2 + "lol"
            return a
        
        
        PARTITION(number p, number r)
            ff=3
            return ff
            
        LOL()
            asd=0
    '''

    /*val code = '''
     * 	ANNABELLE(nUMBeR alder, Number hoyde)
     * 	i = 2
     * 	i += 8
     * 	i++
     * 	s=9
     * 	if 9==2 then
     * 		s= 0
     * 	
     '''*/
    @Test def void parseModel() {
        val result = parseHelper.parse(code)
        println(EmfFormatter.objToStr(result))
        val errors = result.eResource.errors
        Assertions.assertTrue(errors.isEmpty, '''Unexpected errors: «errors.join(", ")»''')
    }

    @Test def compileModel() {
        code.assertCompilesTo('''
            public class ANNABELLE {
                private String title;
            
                     public String implementation(asd) {
                         
                         return title;
                     }
            }
        ''')
    }

}
